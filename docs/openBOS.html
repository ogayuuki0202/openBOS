

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>openBOS package &mdash; openBOS 0.0.20 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/documentation_options.js?v=056c92e6"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="openBOS" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            openBOS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">openBOS</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">openBOS package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-openBOS.culculate_refractiveindex">openBOS.culculate_refractiveindex module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#openBOS.culculate_refractiveindex.SOR_2D"><code class="docutils literal notranslate"><span class="pre">SOR_2D()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-openBOS.reconstruction">openBOS.reconstruction module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#openBOS.reconstruction.ART"><code class="docutils literal notranslate"><span class="pre">ART()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#openBOS.reconstruction.abel_transform"><code class="docutils literal notranslate"><span class="pre">abel_transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-openBOS.reconstruction_utils">openBOS.reconstruction_utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#openBOS.reconstruction_utils.sinogram_maker_axialsymmetry"><code class="docutils literal notranslate"><span class="pre">sinogram_maker_axialsymmetry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-openBOS.shift">openBOS.shift module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#openBOS.shift.SP_BOS"><code class="docutils literal notranslate"><span class="pre">SP_BOS()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#openBOS.shift.SSIM"><code class="docutils literal notranslate"><span class="pre">SSIM()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-openBOS.shift_utils">openBOS.shift_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-openBOS.utils">openBOS.utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#openBOS.utils.compute_laplacian_in_chunks_2D"><code class="docutils literal notranslate"><span class="pre">compute_laplacian_in_chunks_2D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#openBOS.utils.compute_laplacian_in_chunks_3D"><code class="docutils literal notranslate"><span class="pre">compute_laplacian_in_chunks_3D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#openBOS.utils.get_gladstone_dale_constant"><code class="docutils literal notranslate"><span class="pre">get_gladstone_dale_constant()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#openBOS.utils.shift2angle"><code class="docutils literal notranslate"><span class="pre">shift2angle()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-openBOS">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">openBOS package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-openBOS.culculate_refractiveindex">openBOS.culculate_refractiveindex module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#openBOS.culculate_refractiveindex.SOR_2D"><code class="docutils literal notranslate"><span class="pre">SOR_2D()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-openBOS.reconstruction">openBOS.reconstruction module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#openBOS.reconstruction.ART"><code class="docutils literal notranslate"><span class="pre">ART()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#openBOS.reconstruction.abel_transform"><code class="docutils literal notranslate"><span class="pre">abel_transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-openBOS.reconstruction_utils">openBOS.reconstruction_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#openBOS.reconstruction_utils.sinogram_maker_axialsymmetry"><code class="docutils literal notranslate"><span class="pre">sinogram_maker_axialsymmetry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-openBOS.shift">openBOS.shift module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#openBOS.shift.SP_BOS"><code class="docutils literal notranslate"><span class="pre">SP_BOS()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#openBOS.shift.SSIM"><code class="docutils literal notranslate"><span class="pre">SSIM()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-openBOS.shift_utils">openBOS.shift_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-openBOS.utils">openBOS.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#openBOS.utils.compute_laplacian_in_chunks_2D"><code class="docutils literal notranslate"><span class="pre">compute_laplacian_in_chunks_2D()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#openBOS.utils.compute_laplacian_in_chunks_3D"><code class="docutils literal notranslate"><span class="pre">compute_laplacian_in_chunks_3D()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#openBOS.utils.get_gladstone_dale_constant"><code class="docutils literal notranslate"><span class="pre">get_gladstone_dale_constant()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#openBOS.utils.shift2angle"><code class="docutils literal notranslate"><span class="pre">shift2angle()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-openBOS">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">openBOS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">openBOS</a></li>
      <li class="breadcrumb-item active">openBOS package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/openBOS.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="openbos-package">
<h1>openBOS package<a class="headerlink" href="#openbos-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-openBOS.culculate_refractiveindex">
<span id="openbos-culculate-refractiveindex-module"></span><h2>openBOS.culculate_refractiveindex module<a class="headerlink" href="#module-openBOS.culculate_refractiveindex" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="openBOS.culculate_refractiveindex.SOR_2D">
<span class="sig-prename descclassname"><span class="pre">openBOS.culculate_refractiveindex.</span></span><span class="sig-name descname"><span class="pre">SOR_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array_laplacian</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_SOR</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_stable_iters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openBOS.culculate_refractiveindex.SOR_2D" title="Link to this definition">¶</a></dt>
<dd><p>Performs the Successive Over-Relaxation (SOR) method on a 2D Laplacian array to solve for steady-state solutions
within each slice of the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array_laplacian</strong> (<em>np.ndarray</em>) – A 3D numpy array where each slice represents a 2D Laplacian grid to be solved.</p></li>
<li><p><strong>omega_SOR</strong> (<em>float</em>) – The relaxation factor for the SOR method. Values between 1 and 2 can speed up convergence.</p></li>
<li><p><strong>e</strong> (<em>float</em>) – The convergence tolerance threshold for each slice. Iterations stop once the change (<cite>delta</cite>)
falls below this threshold.</p></li>
<li><p><strong>tolerance</strong> (<em>float</em><em>, </em><em>optional</em>) – The tolerance level to determine stability in convergence. Defaults to 1e-24.</p></li>
<li><p><strong>max_stable_iters</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of stable iterations allowed per slice before termination, regardless of convergence.
Defaults to 1000000.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 3D numpy array containing the steady-state solution <cite>u</cite> for each 2D slice in <cite>array_laplacian</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The SOR method updates each element in the <cite>u</cite> array by considering its neighbors and applying the
relaxation factor <cite>omega_SOR</cite>.</p></li>
<li><p>Boundaries are fixed to zero for each slice, enforcing Dirichlet boundary conditions.</p></li>
<li><p>Convergence for each slice stops either when <cite>delta</cite> is less than <cite>e</cite> or after a stable count of
iterations (determined by <cite>tolerance</cite> and <cite>max_stable_iters</cite>) has been reached.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">laplacian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># 10 slices of 100x100 grids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solution</span> <span class="o">=</span> <span class="n">SOR_2D</span><span class="p">(</span><span class="n">laplacian</span><span class="p">,</span> <span class="n">omega_SOR</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(10, 100, 100)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-openBOS.reconstruction">
<span id="openbos-reconstruction-module"></span><h2>openBOS.reconstruction module<a class="headerlink" href="#module-openBOS.reconstruction" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="openBOS.reconstruction.ART">
<span class="sig-prename descclassname"><span class="pre">openBOS.reconstruction.</span></span><span class="sig-name descname"><span class="pre">ART</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sinogram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openBOS.reconstruction.ART" title="Link to this definition">¶</a></dt>
<dd><p>Perform Algebraic Reconstruction Technique (ART) to reconstruct images from a sinogram.</p>
<p>The ART method iteratively updates pixel values to minimize the error between projections
and the input sinogram, facilitating accurate image reconstruction from projections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sinogram</strong> (<em>np.ndarray</em>) – A 2D or 3D numpy array representing the sinogram. Each row corresponds to a projection
at a specific angle.</p></li>
<li><p><strong>mu</strong> (<em>float</em>) – The relaxation parameter controlling the update step size during the iterative process.</p></li>
<li><p><strong>e</strong> (<em>float</em>) – The convergence threshold for the maximum absolute error in the reconstruction.</p></li>
<li><p><strong>bpos</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, enforces non-negative pixel values in the reconstruction, by default True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of reconstructed 2D arrays, each corresponding to a projection set in the input sinogram.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function dynamically adjusts the grid size <cite>N</cite> until it matches the shape of the sinogram projections.</p></li>
<li><p>The <cite>radon</cite> and <cite>iradon</cite> functions from <cite>skimage.transform</cite> are used to perform forward and backward
projections, respectively.</p></li>
<li><p>The method stops when the maximum absolute error between successive updates falls below <cite>e</cite>.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sinogram</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>  <span class="c1"># Example sinogram with 180 projections of length 128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reconstructed_images</span> <span class="o">=</span> <span class="n">ART</span><span class="p">(</span><span class="n">sinogram</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">reconstructed_images</span><span class="p">))</span>
<span class="go">180</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openBOS.reconstruction.abel_transform">
<span class="sig-prename descclassname"><span class="pre">openBOS.reconstruction.</span></span><span class="sig-name descname"><span class="pre">abel_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openBOS.reconstruction.abel_transform" title="Link to this definition">¶</a></dt>
<dd><p>Perform the Abel transform to convert refractive angle values into density differences.</p>
<p>This function applies the Abel transform on a 2D array of refractive angles. It compensates
for background movement by subtracting the mean value at a reference x-coordinate, calculates
distances from the center axis, and integrates to derive density differences using the
Gladstone-Dale constant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angle</strong> (<em>np.ndarray</em>) – A 2D numpy array representing refractive angles for each pixel.</p></li>
<li><p><strong>center</strong> (<em>float</em>) – The index along the y-axis corresponding to the central axis of the transform.</p></li>
<li><p><strong>ref_x</strong> (<em>float</em>) – A reference x-coordinate to compute and offset background movement.</p></li>
<li><p><strong>G</strong> (<em>float</em>) – The Gladstone-Dale constant, used to convert the computed refractive index differences
to density differences.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D array of density differences derived from the Abel transform.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function calculates density differences through an integral-based approach. The refractive
angle image is rotated to align with the axis of symmetry, and values are integrated from the
center outwards, adjusting for axial symmetry.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">angle_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>  <span class="c1"># Simulated refractive angle image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">density_differences</span> <span class="o">=</span> <span class="n">abel_transform</span><span class="p">(</span><span class="n">angle_image</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">ref_x</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">density_differences</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(150,)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-openBOS.reconstruction_utils">
<span id="openbos-reconstruction-utils-module"></span><h2>openBOS.reconstruction_utils module<a class="headerlink" href="#module-openBOS.reconstruction_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="openBOS.reconstruction_utils.sinogram_maker_axialsymmetry">
<span class="sig-prename descclassname"><span class="pre">openBOS.reconstruction_utils.</span></span><span class="sig-name descname"><span class="pre">sinogram_maker_axialsymmetry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openBOS.reconstruction_utils.sinogram_maker_axialsymmetry" title="Link to this definition">¶</a></dt>
<dd><p>Generates a sinogram with axial symmetry from a single 2D refractive angle image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>angle</strong> (<em>np.ndarray</em>) – A 2D numpy array representing the refractive angle image. Each row in this array
is broadcast across the height dimension to simulate an axially symmetric sinogram.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 3D numpy array representing the sinogram with axial symmetry. Each slice along
the first dimension corresponds to a projection at a different angle, where each
projection is a symmetric repetition of the refractive angle row values across
the height and width dimensions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function assumes axial symmetry for the generated sinogram by replicating each row
of the input angle image across both dimensions (height and width) for each slice in
the 3D sinogram. The input image is first rotated by 90 degrees for alignment.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">angle_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>  <span class="c1"># A 100x200 refractive angle image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sinogram</span> <span class="o">=</span> <span class="n">sinogram_maker_axialsymmetry</span><span class="p">(</span><span class="n">angle_image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sinogram</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(200, 200, 200)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-openBOS.shift">
<span id="openbos-shift-module"></span><h2>openBOS.shift module<a class="headerlink" href="#module-openBOS.shift" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="openBOS.shift.SP_BOS">
<span class="sig-prename descclassname"><span class="pre">openBOS.shift.</span></span><span class="sig-name descname"><span class="pre">SP_BOS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openBOS.shift.SP_BOS" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the displacement map of stripe patterns in experimental images using the Background Oriented Schlieren (BOS) method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_array</strong> (<em>np.ndarray</em>) – The reference grayscale image array.</p></li>
<li><p><strong>exp_array</strong> (<em>np.ndarray</em>) – The experimental grayscale image array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The displacement map with background movement compensated. Each value represents the relative movement
of stripes between the reference and experimental images, with noise and background displacements removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method follows these steps:
1. Vertically stretches both reference and experimental images by a factor of 10.
2. Binarizes the stretched images to detect stripe boundaries.
3. Identifies upper and lower stripe boundaries and calculates stripe centers for both images.
4. Filters noise by removing large displacement values.
5. Computes displacement between stripe centers.
6. Compensates for background movement by normalizing the displacement map.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openBOS.shift.SSIM">
<span class="sig-prename descclassname"><span class="pre">openBOS.shift.</span></span><span class="sig-name descname"><span class="pre">SSIM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openBOS.shift.SSIM" title="Link to this definition">¶</a></dt>
<dd><p>Compute the inverted Structural Similarity Index (SSIM) difference matrix between two grayscale images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_array</strong> (<em>np.ndarray</em>) – The reference grayscale image array.</p></li>
<li><p><strong>exp_array</strong> (<em>np.ndarray</em>) – The experimental grayscale image array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The inverted SSIM difference matrix, where higher values indicate greater dissimilarity between the two images.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-openBOS.shift_utils">
<span id="openbos-shift-utils-module"></span><h2>openBOS.shift_utils module<a class="headerlink" href="#module-openBOS.shift_utils" title="Link to this heading">¶</a></h2>
</section>
<section id="module-openBOS.utils">
<span id="openbos-utils-module"></span><h2>openBOS.utils module<a class="headerlink" href="#module-openBOS.utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="openBOS.utils.compute_laplacian_in_chunks_2D">
<span class="sig-prename descclassname"><span class="pre">openBOS.utils.</span></span><span class="sig-name descname"><span class="pre">compute_laplacian_in_chunks_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#openBOS.utils.compute_laplacian_in_chunks_2D" title="Link to this definition">¶</a></dt>
<dd><p>Computes the Laplacian of an input 2D tensor in smaller chunks, allowing for
memory-efficient processing of large tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>torch.Tensor</em>) – The input 2D tensor for which the Laplacian is to be computed.</p></li>
<li><p><strong>chunk_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The size of the chunks to be processed (default is 100).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed Laplacian of the input tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openBOS.utils.compute_laplacian_in_chunks_3D">
<span class="sig-prename descclassname"><span class="pre">openBOS.utils.</span></span><span class="sig-name descname"><span class="pre">compute_laplacian_in_chunks_3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#openBOS.utils.compute_laplacian_in_chunks_3D" title="Link to this definition">¶</a></dt>
<dd><p>Computes the Laplacian of an input 3D tensor in smaller chunks, allowing for
memory-efficient processing of large tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>torch.Tensor</em>) – The input 3D tensor for which the Laplacian is to be computed.</p></li>
<li><p><strong>chunk_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The size of the chunks to be processed (default is 100).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed Laplacian of the input tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openBOS.utils.get_gladstone_dale_constant">
<span class="sig-prename descclassname"><span class="pre">openBOS.utils.</span></span><span class="sig-name descname"><span class="pre">get_gladstone_dale_constant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">humidity</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openBOS.utils.get_gladstone_dale_constant" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the Gladstone-Dale constant based on temperature, pressure, and humidity without using metpy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>float</em>) – Temperature in degrees Celsius (°C).</p></li>
<li><p><strong>pressure</strong> (<em>float</em>) – Pressure in hectopascals (hPa).</p></li>
<li><p><strong>humidity</strong> (<em>float</em>) – Humidity as a percentage (%).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>G<span class="classifier">float</span></dt><dd><p>The calculated Gladstone-Dale constant.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>density<span class="classifier">float</span></dt><dd><p>The density of the atmosphere.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openBOS.utils.shift2angle">
<span class="sig-prename descclassname"><span class="pre">openBOS.utils.</span></span><span class="sig-name descname"><span class="pre">shift2angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor_pitch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution_of_pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lci</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openBOS.utils.shift2angle" title="Link to this definition">¶</a></dt>
<dd><p>Convert the background image displacement to the angle of light refraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shift</strong> (<em>np.ndarray</em>) – Displacement values from the background image.</p></li>
<li><p><strong>ref_array</strong> (<em>np.ndarray</em>) – Reference image array used for calculations.</p></li>
<li><p><strong>sensor_pitch</strong> (<em>float</em>) – The pitch of the image sensor in meters.</p></li>
<li><p><strong>resolution_of_pattern</strong> (<em>float</em>) – The resolution of the pattern in meters per pixel.</p></li>
<li><p><strong>Lb</strong> (<em>float</em>) – Distance from the background to the object being captured.</p></li>
<li><p><strong>Lci</strong> (<em>float</em>) – Distance from the image sensor to the object being captured.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>angle<span class="classifier">np.ndarray</span></dt><dd><p>The calculated angles of light refraction.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Lc<span class="classifier">float</span></dt><dd><p>The distance from the object to the lens.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Li<span class="classifier">float</span></dt><dd><p>The distance from the lens to the image sensor.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>projection_ratio<span class="classifier">float</span></dt><dd><p>The ratio of projection based on the dimensions.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-openBOS">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-openBOS" title="Link to this heading">¶</a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="openBOS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Yuuki Ogasawara.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>